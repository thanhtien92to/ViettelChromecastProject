"use strict";var castReceiverPlayer=castReceiverPlayer||{},attchedvideoClassName=".video",overlayClassName=".media-info-show-part",watermarkClassName=".watermark",mediaInformationClassName=".media-info",mediaTextClassName=".media-tex",mediaArtworkClassName=".media-artwork",mediaTitleClassName=".media-title",mediaSubtitleClassName=".media-subtitle",mediaArtWorkQueueClassName=".media-artwork-queue-insert",mediaTitleQueueClassName=".media-title-queue-insert",mediaSubtitleQueueClassName=".media-subtitle-queue-insert",previewModeInformationClassName=".preview-info",previewModeArtworkClassName=".preview-artwork",previewModeTextClassName=".preview-text",previewModeTimerClassName=".preview-timer",previewModeTimerStartsClassName=".preview-timer-starts",previewModeTimerCountdownClassName=".preview-timer-countdown",previewModeTimerSecClassName=".preview-timer-sec",previewModeTitleClassName=".preview-title",previewModeSubtitleClassName=".preview-subtitle",controlsClassName=".controls",controlsPlayPauseClassName=".controls-play-pause",controlsCurrentTimeClassName=".controls-cur-time",controlsTotalTimeClassName=".controls-total-time",controlsProgressClassName=".controls-progress",controlsProgressInnerClassName=".controls-progress-inner",controlsProgressThumbClassName=".controls-progress-thumb",vodTitle=".vod-title",vodDirector=".vod-director",vodStar=".vod-star",vodSubtitle=".vod-subtitle",vodPoster=".vod-poster",domElementArtributePreviewMode="preview",domElementArtributeType="type",domElementArtributeState="state",domElementArtributeLive="live",domElementArtributeLang="lang",domElementArtributeCastCatchup="iscatchup";castReceiverPlayer.ChromecastPlayer=function(e){var t="video/mp4",a="avc1.42E01E, mp4a.40.2",r=document.createElement("video"),i=r.canPlayType(t+';codecs="'+a+'"');""==i&&(i="No"),console.log("Supported MP4? : "+i),this.debug_=castReceiverPlayer.ENABLE_DEBUG_,this.debug_&&(cast.player.api.setLoggerLevel(cast.player.api.LoggerLevel.DEBUG),cast.receiver.logger.setLevelValue(cast.receiver.LoggerLevel.DEBUG)),this.domElement_=e;var o=navigator.language||navigator.userLanguage;"vi"==o?(this.domElement_.setAttribute(domElementArtributeLang,"vi"),document.getElementById("vodDirectorTag").innerHTML="Đạo Diễn",document.getElementById("vodStarTag").innerHTML="Diễn Viên"):(this.domElement_.setAttribute(domElementArtributeLang,"vi"),document.getElementById("vodDirectorTag").innerHTML="Đạo Diễn",document.getElementById("vodStarTag").innerHTML="Diễn Viên"),this.mediaType_,this.setMediaType_(castReceiverPlayer.Type.UNKNOWN,!1),this.playerState_,this.lastStateTransitionTime_=0,this.setPlayerState_(castReceiverPlayer.State.LAUNCHING,!1),this.burnInPreventionIntervalId_,this.idleTimerId_,this.curAppState_,this.progressBarInnerElement_=this.getElementByClass_(controlsProgressInnerClassName),this.progressBarThumbElement_=this.getElementByClass_(controlsProgressThumbClassName),this.curTimeElement_=this.getElementByClass_(controlsCurrentTimeClassName),this.totalTimeElement_=this.getElementByClass_(controlsTotalTimeClassName),this.previewModeTimerElement_=this.getElementByClass_(previewModeTimerCountdownClassName),this.bufferingHandler_=this.onBuffering_.bind(this),this.player_=null,this.preloadPlayer_=null,this.textTrackType_=null,this.playerAutoPlay_=!1,this.displayPreviewMode_=!1,this.deferredPlayCallbackId_=null,this.playerReady_=!1,this.metadataLoaded_=!1,this.loadedMediaInfor_=null,this.loadedLiveDuration_=1/0,this.mediaElement_=this.domElement_.querySelector(attchedvideoClassName),this.mediaElement_.addEventListener("error",this.onError_.bind(this),!1),this.mediaElement_.addEventListener("playing",this.onPlaying_.bind(this),!1),this.mediaElement_.addEventListener("pause",this.onPause_.bind(this),!1),this.mediaElement_.addEventListener("ended",this.onEnded_.bind(this),!1),this.mediaElement_.addEventListener("abort",this.onAbort_.bind(this),!1),this.mediaElement_.addEventListener("timeupdate",this.onProgress_.bind(this),!1),this.mediaElement_.addEventListener("seeking",this.onSeekStart_.bind(this),!1),this.mediaElement_.addEventListener("seeked",this.onSeekEnd_.bind(this),!1),this.receiverManager_=cast.receiver.CastReceiverManager.getInstance(),this.receiverManager_.onReady=this.onReady_.bind(this),this.receiverManager_.onSenderDisconnected=this.onSenderDisconnected_.bind(this),this.receiverManager_.onVisibilityChanged=this.onVisibilityChanged_.bind(this),this.receiverManager_.setApplicationState(castReceiverPlayer.getApplicationState_()),this.mediaManager_=new cast.receiver.MediaManager(this.mediaElement_),this.onLoadOrig_=this.mediaManager_.onLoad.bind(this.mediaManager_),this.mediaManager_.onLoad=this.onLoad_.bind(this),this.onEditTracksInfoOrig_=this.mediaManager_.onEditTracksInfo.bind(this.mediaManager_),this.mediaManager_.onEditTracksInfo=this.onEditTracksInfo_.bind(this),this.onMetadataLoadedOrig_=this.mediaManager_.onMetadataLoaded.bind(this.mediaManager_),this.mediaManager_.onMetadataLoaded=this.onMetadataLoaded_.bind(this),this.onStopOrig_=this.mediaManager_.onStop.bind(this.mediaManager_),this.mediaManager_.onStop=this.onStop_.bind(this),this.onLoadMetadataErrorOrig_=this.mediaManager_.onLoadMetadataError.bind(this.mediaManager_),this.mediaManager_.onLoadMetadataError=this.onLoadMetadataError_.bind(this),this.onErrorOrig_=this.mediaManager_.onError.bind(this.mediaManager_),this.mediaManager_.onError=this.onError_.bind(this),this.onQueueEndedOrig_=this.mediaManager_.onQueueEnded.bind(this.mediaManager_),this.mediaManager_.onQueueEnded=this.onQueueEnded_.bind(this),this.onQueueInsertOrig_=this.mediaManager_.onQueueInsert.bind(this.mediaManager_),this.mediaManager_.onQueueInsert=this.onQueueInsert_.bind(this),this.onQueueLoadOrig_=this.mediaManager_.onQueueLoad.bind(this.mediaManager_),this.mediaManager_.onQueueLoad=this.onQueueLoad_.bind(this),this.onQueueRemoveOrig_=this.mediaManager_.onQueueRemove.bind(this.mediaManager_),this.mediaManager_.onQueueRemove=this.onQueueRemove_.bind(this),this.onQueueReorderOrig_=this.mediaManager_.onQueueReorder.bind(this.mediaManager_),this.mediaManager_.onQueueReorder=this.onQueueReorder_.bind(this),this.onQueueUpdateOrig_=this.mediaManager_.onQueueUpdate.bind(this.mediaManager_),this.mediaManager_.onQueueUpdate=this.onQueueUpdate_.bind(this),this.mediaManager_.customizedStatusCallback=this.customizedStatusCallback_.bind(this),this.mediaManager_.onPreload=this.onPreload_.bind(this),this.mediaManager_.onCancelPreload=this.onCancelPreload_.bind(this)},castReceiverPlayer.ChromecastPlayer.prototype.getMediaElement=function(){return this.mediaElement_},castReceiverPlayer.ChromecastPlayer.prototype.getMediaManager=function(){return this.mediaManager_},castReceiverPlayer.ChromecastPlayer.prototype.getPlayer=function(){return this.player_},castReceiverPlayer.ChromecastPlayer.prototype.start=function(){this.receiverManager_.start()},castReceiverPlayer.ChromecastPlayer.prototype.onError_=function(e){console.log("Player Event --- onError");var t=this;castReceiverPlayer.transition_(t.domElement_,castReceiverPlayer.TRANSITION_DURATION_,function(){t.setPlayerState_(castReceiverPlayer.State.IDLE,!1),t.onErrorOrig_(e)})},castReceiverPlayer.ChromecastPlayer.prototype.onPlaying_=function(){console.log("Player Event --- onEvent"),this.cancelDeferredPlay_("media is already playing");this.mediaType_==castReceiverPlayer.Type.AUDIO,this.playerState_==castReceiverPlayer.State.LOADING;this.setPlayerState_(castReceiverPlayer.State.PLAYING,!1)},castReceiverPlayer.ChromecastPlayer.prototype.onPause_=function(){console.log("Player Event --- onPause"),this.cancelDeferredPlay_("media is paused");var e=this.playerState_===castReceiverPlayer.State.IDLE,t=this.mediaElement_.currentTime===this.mediaElement_.duration,a=this.player_&&this.player_.getState().underflow;a?(console.log("isUnderflow"),this.setPlayerState_(castReceiverPlayer.State.BUFFERING,!1),this.mediaManager_.broadcastStatus(!1)):e||t||this.setPlayerState_(castReceiverPlayer.State.PAUSED,!1),this.updateProgress_()},castReceiverPlayer.ChromecastPlayer.prototype.onEnded_=function(){console.log("Player Event --- onEnded"),this.setPlayerState_(castReceiverPlayer.State.IDLE,!1),this.hidePreviewMode_()},castReceiverPlayer.ChromecastPlayer.prototype.onAbort_=function(){console.log("Player Event --- onAbort"),this.setPlayerState_(castReceiverPlayer.State.IDLE,!1),this.hidePreviewMode_()},castReceiverPlayer.ChromecastPlayer.prototype.onProgress_=function(){console.log("Player Event --- onProgress"),(this.playerState_===castReceiverPlayer.State.BUFFERING||this.playerState_===castReceiverPlayer.State.LOADING)&&this.setPlayerState_(castReceiverPlayer.State.PLAYING,!1),this.updateProgress_()},castReceiverPlayer.ChromecastPlayer.prototype.onSeekStart_=function(){console.log("Player Event --- onSeekStart"),clearTimeout(this.seekingTimeoutId_),this.domElement_.classList.add("seeking")},castReceiverPlayer.ChromecastPlayer.prototype.onSeekEnd_=function(){console.log("Player Event --- onSeekEnd"),clearTimeout(this.seekingTimeoutId_),this.seekingTimeoutId_=castReceiverPlayer.addClassWithTimeout_(this.domElement_,"seeking",100)},castReceiverPlayer.ChromecastPlayer.prototype.onReady_=function(){console.log("CastReceiverManager --- onReady"),this.setPlayerState_(castReceiverPlayer.State.IDLE,!1)},castReceiverPlayer.ChromecastPlayer.prototype.onSenderDisconnected_=function(e){console.log("CastReceiverManager --- onSenderDisconnected"),console.log("onSenderDisconnected: Event --- "+JSON.stringify(e)),0===this.receiverManager_.getSenders().length&&e.reason===cast.receiver.system.DisconnectReason.REQUESTED_BY_SENDER&&this.receiverManager_.stop(),console.log(" (End) CastReceiverManager --- onSenderDisconnected")},castReceiverPlayer.ChromecastPlayer.prototype.onVisibilityChanged_=function(e){console.log("CastReceiverManager --- onVisibilityChanged"),e.isVisible||(this.mediaElement_.pause(),this.mediaManager_.broadcastStatus(!1))},castReceiverPlayer.getApplicationState_=function(e){return e&&e.metadata&&e.metadata.title?"Now Casting: "+e.metadata.title:e?"Now Casting":"Ready To Cast"},castReceiverPlayer.ChromecastPlayer.prototype.onLoad_=function(e){console.log("MediaManager Event --- onLoad"),console.log("onLoad --- event: "+JSON.stringify(e)),this.loadedMediaInfor_=e,this.loadedLiveDuration_=e.data.media.duration,console.log("loadedLiveDuration_ = "+this.loadedLiveDuration_),this.cancelDeferredPlay_("new media is loaded"),this.load(new cast.receiver.MediaManager.LoadInfo(e.data,e.senderId)),console.log(" (End) MediaManager Event --- onLoad")},castReceiverPlayer.ChromecastPlayer.prototype.onEditTracksInfo_=function(e){if(console.log("MediaManager Event --- onEditTracksInfo"),this.onEditTracksInfoOrig_(e),e.data&&e.data.activeTrackIds&&this.textTrackType_){var t=this.mediaManager_.getMediaInformation()||{},a=this.textTrackType_;a==castReceiverPlayer.TextTrackType.SIDE_LOADED_TTML?(this.player_&&this.player_.enableCaptions(!1,cast.player.api.CaptionsType.TTML),this.processTtmlCues_(e.data.activeTrackIds,t.tracks||[])):a==castReceiverPlayer.TextTrackType.EMBEDDED&&(this.player_.enableCaptions(!1),this.processInBandTracks_(e.data.activeTrackIds),this.player_.enableCaptions(!0))}},castReceiverPlayer.ChromecastPlayer.prototype.onMetadataLoaded_=function(e){console.log("MediaManager Event ---  onMetadataLoaded"),this.onLoadSuccess_(),this.readSideLoadedTextTrackType_(e),this.textTrackType_==castReceiverPlayer.TextTrackType.SIDE_LOADED_TTML&&e.message&&e.message.activeTrackIds&&e.message.media&&e.message.media.tracks?this.processTtmlCues_(e.message.activeTrackIds,e.message.media.tracks):this.textTrackType_||this.maybeLoadEmbeddedTracksMetadata_(e),this.metadataLoaded_=!0,this.maybeSendLoadCompleted_(e),console.log(" (End) MediaManager Event ---  onMetadataLoaded")},castReceiverPlayer.ChromecastPlayer.prototype.onStop_=function(e){console.log("MediaManager Event --- onStop"),this.cancelDeferredPlay_("media is stopped");var t=this;castReceiverPlayer.transition_(t.domElement_,castReceiverPlayer.TRANSITION_DURATION_,function(){t.setPlayerState_(castReceiverPlayer.State.IDLE,!1),t.onStopOrig_(e)})},castReceiverPlayer.ChromecastPlayer.prototype.onLoadMetadataError_=function(e){console.log("MediaManager Event --- onLoadMetadataError_");var t=this;castReceiverPlayer.transition_(t.domElement_,castReceiverPlayer.TRANSITION_DURATION_,function(){t.setPlayerState_(castReceiverPlayer.State.IDLE,!1),t.onLoadMetadataErrorOrig_(e)})},castReceiverPlayer.ChromecastPlayer.prototype.customizedStatusCallback_=function(e){return console.log("customizedStatusCallback_: playerState="+e.playerState+", this.playerState_="+this.playerState_),e.playerState===cast.receiver.media.PlayerState.PAUSED&&this.playerState_===castReceiverPlayer.State.BUFFERING&&(e.playerState=cast.receiver.media.PlayerState.BUFFERING),e},castReceiverPlayer.ChromecastPlayer.prototype.onPreload_=function(e){console.log("MediaManager Event --- onPreload");var t=e.data;return this.preload(t.media)},castReceiverPlayer.ChromecastPlayer.prototype.onCancelPreload_=function(e){return console.log("MediaManager Event --- onCancelPreload_"),this.hidePreviewMode_(),!0},castReceiverPlayer.ChromecastPlayer.prototype.onQueueEnded_=function(e){console.log("MediaManager Event --- onQueueEnded_"),console.log("onQueueEnded_ (event) event : "+JSON.stringify(e));var t=this;t.onQueueEndedOrig_(e)},castReceiverPlayer.ChromecastPlayer.prototype.onQueueInsert_=function(e){if(console.log("MediaManager Event --- onQueueInsert_"),console.log("onQueueInsert_ (event) event : "+JSON.stringify(e)),console.log("loadMetadata_"),!castReceiverPlayer.isCastForAudioDevice_()){var t=e.data.items[0].media;if(t){var a=t.metadata||{},r=this.domElement_.querySelector(mediaTitleQueueClassName);castReceiverPlayer.setInnerText_(r,a.title);var i=this.domElement_.querySelector(mediaSubtitleQueueClassName);castReceiverPlayer.setInnerText_(i,"Add to queue");var o=castReceiverPlayer.getMediaImageUrl_(t);if(o){var s=this.domElement_.querySelector(mediaArtWorkQueueClassName);castReceiverPlayer.setBackgroundImage_(s,o)}}}castReceiverPlayer.addClassWithTimeout_(this.domElement_,"queue-event",5e3);var n=this;n.onQueueInsertOrig_(e)},castReceiverPlayer.ChromecastPlayer.prototype.onQueueLoad_=function(e){console.log("MediaManager Event --- onQueueLoad_"),console.log("onQueueLoad_ (event) event : "+JSON.stringify(e));var t=this;t.onQueueLoadOrig_(e)},castReceiverPlayer.ChromecastPlayer.prototype.onQueueRemove_=function(e){console.log("MediaManager Event --- onQueueRemove_"),console.log("onQueueRemove_ (event) event : "+JSON.stringify(e));var t=this;t.onQueueRemoveOrig_(e)},castReceiverPlayer.ChromecastPlayer.prototype.onQueueReorder_=function(e){console.log("MediaManager Event --- onQueueReorder_"),console.log("onQueueReorder_ (event) event : "+JSON.stringify(e));var t=this;t.onQueueReorderOrig_(e)},castReceiverPlayer.ChromecastPlayer.prototype.onQueueUpdate_=function(e){console.log("MediaManager Event ---onQueueUpdate_"),console.log("onQueueUpdate_ (event) event : "+JSON.stringify(e));var t=this;t.onQueueUpdateOrig_(e)},castReceiverPlayer.IDLE_TIMEOUT={LAUNCHING:36e4,LOADING:12e4,PAUSED:6e5,DONE:36e4,IDLE:36e4},castReceiverPlayer.Type={AUDIO:"audio",VIDEO:"video",UNKNOWN:"unknown"},castReceiverPlayer.TextTrackType={SIDE_LOADED_TTML:"ttml",SIDE_LOADED_VTT:"vtt",SIDE_LOADED_UNSUPPORTED:"unsupported",EMBEDDED:"embedded"},castReceiverPlayer.CaptionsMimeType={TTML:"application/ttml+xml",VTT:"text/vtt"},castReceiverPlayer.TrackType={AUDIO:"audio",VIDEO:"video",TEXT:"text"},castReceiverPlayer.State={LAUNCHING:"launching",LOADING:"loading",BUFFERING:"buffering",PLAYING:"playing",PAUSED:"paused",DONE:"done",IDLE:"idle"},castReceiverPlayer.BURN_IN_TIMEOUT=3e4,castReceiverPlayer.MEDIA_INFO_DURATION_=3e3,castReceiverPlayer.TRANSITION_DURATION_=.5,castReceiverPlayer.ENABLE_DEBUG_=!0,castReceiverPlayer.DISABLE_DEBUG_=!1,castReceiverPlayer.ChromecastPlayer.prototype.preload=function(e){if(console.log("function - preload"),castReceiverPlayer.canDisplayPreview_(e||{}))return this.showPreviewMode_(e),!0;if(!castReceiverPlayer.supportsPreload_(e||{}))return console.log("preload - no supportsPreload_"),!1;this.preloadPlayer_&&(this.preloadPlayer_.unload(),this.preloadPlayer_=null);var t=this.preloadVideo_(e);return t&&this.showPreviewMode_(e),console.log("preload - couldPreload="+t),console.log("(end) function - preload"),t},castReceiverPlayer.ChromecastPlayer.prototype.showPreviewModeMetadata=function(e){this.domElement_.setAttribute(domElementArtributePreviewMode,e.toString())},castReceiverPlayer.ChromecastPlayer.prototype.showPreviewMode_=function(e){this.displayPreviewMode_=!0,this.loadPreviewModeMetadata_(e),this.showPreviewModeMetadata(!0)},castReceiverPlayer.ChromecastPlayer.prototype.hidePreviewMode_=function(){this.showPreviewModeMetadata(!1),this.displayPreviewMode_=!1},castReceiverPlayer.ChromecastPlayer.prototype.preloadVideo_=function(e){console.log("preloadVideo_");var t=this,a=e.contentId,r=castReceiverPlayer.getProtocolFunction_(e);if(!r)return console.log("No protocol found for preload"),!1;var i=new cast.player.api.Host({url:a,mediaElement:t.mediaElement_});return i.updateLicenseRequestInfo=function(e){console.log("updateLicenseRequestInfo --- requestInfo : "+JSON.stringify(e)),e.headers={},e.headers.AUTHORIZATION="BASIC QWx0aWNhc3Q6RFJNU2VydmljZQ==",e.headers.host="sec.viettelttv.com.vn"},i.onError=function(){t.preloadPlayer_.unload(),t.preloadPlayer_=null,t.showPreviewModeMetadata(!1),t.displayPreviewMode_=!1,console.log("Error during preload")},t.preloadPlayer_=new cast.player.api.Player(i),t.preloadPlayer_.preload(r(i)),!0},castReceiverPlayer.ChromecastPlayer.prototype.load=function(e){console.log("load cast.receiver.MediaManager.LoadInfo object"),clearTimeout(this.idleTimerId_);var t=this,a=e.message.media||{},r=a.contentType,i=castReceiverPlayer.getType_(a),o=a.streamType===cast.receiver.media.StreamType.LIVE;if(o=o||"CAST_CATCHUP"==a.metadata.CHROME_MEDIA_TYPE,"CAST_CATCHUP"==a.metadata.CHROME_MEDIA_TYPE&&this.domElement_.setAttribute(domElementArtributeCastCatchup,"CAST_CATCHUP"),a.contentId)if(i===castReceiverPlayer.Type.UNKNOWN)console.log("Load failed: unknown content type: "+r),t.onLoadMetadataError_(e);else{console.log("Loading: "+i),t.resetMediaElement_(),t.setMediaType_(i,o);var s=!1;switch(i){case castReceiverPlayer.Type.AUDIO:t.loadAudio_(e);break;case castReceiverPlayer.Type.VIDEO:s=t.loadVideo_(e)}t.playerReady_=!1,t.metadataLoaded_=!1,t.loadMetadata_(a),t.showPreviewModeMetadata(!1),t.displayPreviewMode_=!1,castReceiverPlayer.preload_(a,function(){console.log("preloaded="+s),s?(t.setPlayerState_(castReceiverPlayer.State.PLAYING,!1),t.playerReady_=!0,t.maybeSendLoadCompleted_(e),t.deferPlay_(0),t.playerAutoPlay_=!1):castReceiverPlayer.transition_(t.domElement_,castReceiverPlayer.TRANSITION_DURATION_,function(){t.setPlayerState_(castReceiverPlayer.State.LOADING,!1),t.playerReady_=!0,t.maybeSendLoadCompleted_(e),t.playerAutoPlay_&&(t.deferPlay_(castReceiverPlayer.MEDIA_INFO_DURATION_),t.playerAutoPlay_=!1)})})}else console.log("Load failed --- no content"),t.onLoadMetadataError_(e)},castReceiverPlayer.ChromecastPlayer.prototype.maybeSendLoadCompleted_=function(e){this.playerReady_?this.metadataLoaded_?(this.onMetadataLoadedOrig_(e),console.log("Sent load response, player is ready and metadata loaded")):console.log("Deferring load response, loadedmetadata event not received"):console.log("Deferring load response, player not ready")},castReceiverPlayer.ChromecastPlayer.prototype.resetMediaElement_=function(){console.log("resetMediaElement_"),this.player_&&(this.player_.unload(),this.player_=null),this.textTrackType_=null},castReceiverPlayer.ChromecastPlayer.prototype.loadMetadata_=function(e){if(console.log("loadMetadata_"),!castReceiverPlayer.isCastForAudioDevice_()){var t=e.metadata||{},a=this.domElement_.querySelector(mediaTitleClassName);if(castReceiverPlayer.setInnerText_(a,t.title),document.getElementById("vodTitle").innerHTML=t.title,document.getElementById("vodSubtitle").innerHTML=t.subtitle,void 0!=t.CAST_INFO_DIRECTOR)document.getElementById("vodDirector").innerHTML=t.CAST_INFO_DIRECTOR;else{var r=navigator.language||navigator.userLanguage;"vi"==r?document.getElementById("vodDirector").innerHTML="Đang cập nhật":document.getElementById("vodDirector").innerHTML="Updating"}if(void 0!=t.CAST_INFO_STAR)document.getElementById("vodStar").innerHTML=t.CAST_INFO_STAR;else{var r=navigator.language||navigator.userLanguage;"vi"==r?document.getElementById("vodStar").innerHTML="Đang cập nhật":document.getElementById("vodStar").innerHTML="Updating"}void 0!=t.CAST_INFO_LIKES?document.getElementById("vodLikesNumber").innerHTML=t.CAST_INFO_LIKES:document.getElementById("vodLikesNumber").innerHTML="0",void 0!=t.CAST_INFO_PRODUCTION_YEAR?document.getElementById("vodYear").innerHTML=t.CAST_INFO_PRODUCTION_YEAR:document.getElementById("vodYear").innerHTML="0000",void 0!=t.CAST_INFO_GENRES?document.getElementById("vodGenres").innerHTML=t.CAST_INFO_GENRES:document.getElementById("vodGenres").innerHTML="",void 0!=t.CAST_INFO_HOT?1==t.CAST_INFO_HOT?(document.getElementById("vodHotTypeIcon").src="image/icon_new.png",document.getElementById("vodHotTypeIcon").visibility="visible"):2==t.CAST_INFO_HOT?(document.getElementById("vodHotTypeIcon").src="image/icon_hot.png",document.getElementById("vodHotTypeIcon").visibility="visible"):document.getElementById("vodHotTypeIcon").visibility="hidden":document.getElementById("vodHotTypeIcon").visibility="hidden";var i=this.domElement_.querySelector(mediaSubtitleClassName);castReceiverPlayer.setInnerText_(i,t.subtitle);var o=castReceiverPlayer.getMediaImageUrl_(e);if(o){var s=this.domElement_.querySelector(mediaArtworkClassName);castReceiverPlayer.setBackgroundImage_(s,o),document.getElementById("vodPoster").src=o}}},castReceiverPlayer.ChromecastPlayer.prototype.loadPreviewModeMetadata_=function(e){if(console.log("loadPreviewModeMetadata_"),!castReceiverPlayer.isCastForAudioDevice_()){var t=e.metadata||{},a=this.domElement_.querySelector(previewModeTitleClassName);castReceiverPlayer.setInnerText_(a,t.title);var r=this.domElement_.querySelector(previewModeSubtitleClassName);castReceiverPlayer.setInnerText_(r,t.subtitle);var i=castReceiverPlayer.getMediaImageUrl_(e);if(i){var o=this.domElement_.querySelector(previewModeArtworkClassName);castReceiverPlayer.setBackgroundImage_(o,i)}}},castReceiverPlayer.ChromecastPlayer.prototype.letPlayerHandleAutoPlay_=function(e){console.log("letPlayerHandleAutoPlay_: "+e.message.autoplay);var t=e.message.autoplay;e.message.autoplay=!1,this.mediaElement_.autoplay=!1,this.playerAutoPlay_=void 0==t?!0:t},castReceiverPlayer.ChromecastPlayer.prototype.loadAudio_=function(e){console.log("loadAudio_"),this.letPlayerHandleAutoPlay_(e),this.loadDefault_(e)},castReceiverPlayer.ChromecastPlayer.prototype.loadVideo_=function(e){console.log("loadVideo_");var t=this,a=null,r=e.message.media.contentId,a=castReceiverPlayer.getProtocolFunction_(e.message.media),i=!1;if(this.letPlayerHandleAutoPlay_(e),a){console.log("loadVideo_: using Media Player Library"),this.mediaElement_.removeEventListener("stalled",this.bufferingHandler_),this.mediaElement_.removeEventListener("waiting",this.bufferingHandler_);var o=function(){t.player_&&(t.resetMediaElement_(),t.mediaElement_.dispatchEvent(new Event("error")))};if(!this.preloadPlayer_||this.preloadPlayer_.getHost&&this.preloadPlayer_.getHost().url!=r){this.preloadPlayer_&&(this.preloadPlayer_.unload(),this.preloadPlayer_=null),console.log("Regular video load");var s=new cast.player.api.Host({url:r,mediaElement:this.mediaElement_});s.updateLicenseRequestInfo=function(e){console.log("updateLicenseRequestInfo --- requestInfo : "+JSON.stringify(e)),e.headers={},e.headers.AUTHORIZATION="BASIC QWx0aWNhc3Q6RFJNU2VydmljZQ==",e.headers.host="sec.viettelttv.com.vn"},s.onError=o,this.player_=new cast.player.api.Player(s),this.player_.load(a(s))}else console.log("Preloaded video load"),this.player_=this.preloadPlayer_,this.preloadPlayer_=null,this.player_.getHost().onError=o,this.player_.load(),i=!0}else console.log("loadVideo_: using MediaElement"),this.mediaElement_.addEventListener("stalled",this.bufferingHandler_,!1),this.mediaElement_.addEventListener("waiting",this.bufferingHandler_,!1);return this.loadMediaManagerInfo_(e,!!a),i},castReceiverPlayer.ChromecastPlayer.prototype.loadMediaManagerInfo_=function(e,t){t?this.maybeLoadSideLoadedTracksMetadata_(e):this.loadDefault_(e)},castReceiverPlayer.ChromecastPlayer.prototype.readSideLoadedTextTrackType_=function(e){if(e.message&&e.message.media&&e.message.media.tracks)for(var t=0;t<e.message.media.tracks.length;t++){var a=this.textTrackType_;if(e.message.media.tracks[t].type==cast.receiver.media.TrackType.TEXT){if(this.isTtmlTrack_(e.message.media.tracks[t]))this.textTrackType_=castReceiverPlayer.TextTrackType.SIDE_LOADED_TTML;else{if(!this.isVttTrack_(e.message.media.tracks[t])){console.log("Unsupported side loaded text track types"),this.textTrackType_=castReceiverPlayer.TextTrackType.SIDE_LOADED_UNSUPPORTED;break}this.textTrackType_=castReceiverPlayer.TextTrackType.SIDE_LOADED_VTT}if(a&&a!=this.textTrackType_){console.log("Load has inconsistent text track types"),this.textTrackType_=castReceiverPlayer.TextTrackType.SIDE_LOADED_UNSUPPORTED;break}}}},castReceiverPlayer.ChromecastPlayer.prototype.maybeLoadSideLoadedTracksMetadata_=function(e){if(e.message&&e.message.media&&e.message.media.tracks&&0!=e.message.media.tracks.length){var t={tracks:e.message.media.tracks,activeTrackIds:e.message.activeTrackIds,textTrackStyle:e.message.media.textTrackStyle};this.mediaManager_.loadTracksInfo(t)}},castReceiverPlayer.ChromecastPlayer.prototype.maybeLoadEmbeddedTracksMetadata_=function(e){if(e.message&&e.message.media){var t=this.readInBandTracksInfo_();t&&(this.textTrackType_=castReceiverPlayer.TextTrackType.EMBEDDED,t.textTrackStyle=e.message.media.textTrackStyle,this.mediaManager_.loadTracksInfo(t))}},castReceiverPlayer.ChromecastPlayer.prototype.processTtmlCues_=function(e,t){if(0!=e.length)for(var a=0;a<t.length;a++){for(var r=!1,i=0;i<e.length;i++)if(e[i]==t[a].trackId){r=!0;break}if(r&&this.isTtmlTrack_(t[a])){if(!this.player_){var o=new cast.player.api.Host({url:"",mediaElement:this.mediaElement_});o.updateLicenseRequestInfo=function(e){console.log("updateLicenseRequestInfo --- requestInfo : "+JSON.stringify(e)),e.headers={},e.headers.AUTHORIZATION="BASIC QWx0aWNhc3Q6RFJNU2VydmljZQ==",e.headers.host="sec.viettelttv.com.vn"},this.protocol_=null,this.player_=new cast.player.api.Player(o)}this.player_.enableCaptions(!0,cast.player.api.CaptionsType.TTML,t[a].trackContentId)}}},castReceiverPlayer.ChromecastPlayer.prototype.isTtmlTrack_=function(e){return this.isKnownTextTrack_(e,castReceiverPlayer.TextTrackType.SIDE_LOADED_TTML,castReceiverPlayer.CaptionsMimeType.TTML)},castReceiverPlayer.ChromecastPlayer.prototype.isVttTrack_=function(e){return this.isKnownTextTrack_(e,castReceiverPlayer.TextTrackType.SIDE_LOADED_VTT,castReceiverPlayer.CaptionsMimeType.VTT)},castReceiverPlayer.ChromecastPlayer.prototype.isKnownTextTrack_=function(e,t,a){if(!e)return!1;var r=t,i=e.trackContentId,o=e.trackContentType;return i&&castReceiverPlayer.getExtension_(i)===r||o&&0===o.indexOf(a)?!0:!1},castReceiverPlayer.ChromecastPlayer.prototype.processInBandTracks_=function(e){for(var t=this.player_.getStreamingProtocol(),a=t.getStreamCount(),r=0;a>r;r++){for(var i=r+1,o=!1,s=0;s<e.length;s++)if(e[s]==i){o=!0;break}var n=t.isStreamEnabled(r);o&&!n?t.enableStream(r,!0):!o&&n&&t.enableStream(r,!1)}},castReceiverPlayer.ChromecastPlayer.prototype.readInBandTracksInfo_=function(){var e=this.player_?this.player_.getStreamingProtocol():null;if(!e)return null;for(var t=e.getStreamCount(),a=[],r=[],i=0;t>i;i++){var o=i+1;e.isStreamEnabled(i)&&a.push(o);var s,n=e.getStreamInfo(i),l=n.mimeType;0===l.indexOf(castReceiverPlayer.TrackType.TEXT)||l===castReceiverPlayer.CaptionsMimeType.TTML?s=new cast.receiver.media.Track(o,cast.receiver.media.TrackType.TEXT):0===l.indexOf(castReceiverPlayer.TrackType.VIDEO)?s=new cast.receiver.media.Track(o,cast.receiver.media.TrackType.VIDEO):0===l.indexOf(castReceiverPlayer.TrackType.AUDIO)&&(s=new cast.receiver.media.Track(o,cast.receiver.media.TrackType.AUDIO)),s&&(s.name=n.name,s.language=n.language,s.trackContentType=n.mimeType,r.push(s))}if(0===r.length)return null;var c={tracks:r,activeTrackIds:a};return c},castReceiverPlayer.ChromecastPlayer.prototype.loadDefault_=function(e){this.onLoadOrig_(new cast.receiver.MediaManager.Event(cast.receiver.MediaManager.EventType.LOAD,e.message,e.senderId))},castReceiverPlayer.ChromecastPlayer.prototype.setIdleTimeout_=function(e){console.log("setIdleTimeout_: "+e);var t=this;clearTimeout(this.idleTimerId_),e&&(this.idleTimerId_=setTimeout(function(){t.receiverManager_.stop()},e))},castReceiverPlayer.ChromecastPlayer.prototype.setMediaType_=function(e,t){console.log("setMediaType_: "+e),this.mediaType_=e,this.domElement_.setAttribute(domElementArtributeType,e),this.domElement_.setAttribute(domElementArtributeLive,t.toString());var a=this.getElementByClass_(overlayClassName);this.getElementByClass_(watermarkClassName);clearInterval(this.burnInPreventionIntervalId_),e!=castReceiverPlayer.Type.AUDIO?a.removeAttribute("style"):a.removeAttribute("style")},castReceiverPlayer.ChromecastPlayer.prototype.setPlayerState_=function(e,t,a){console.log("setPlayerState_: state="+e+", crossfade="+t+", delay="+a);var r=this;if(r.lastStateTransitionTime_=Date.now(),clearTimeout(r.delay_),a){var i=function(){r.setPlayerState_(e,t)};r.delay_=setTimeout(i,a)}else if(t){var o=r.lastStateTransitionTime_;castReceiverPlayer.transition_(r.domElement_,castReceiverPlayer.TRANSITION_DURATION_,function(){return o<r.lastStateTransitionTime_?void console.log("discarded obsolete deferred state("+e+")."):void r.setPlayerState_(e,!1)})}else r.playerState_=e,r.domElement_.setAttribute(domElementArtributeState,e),r.updateApplicationState_(),"PLAYING"!=e&&r.setIdleTimeout_(castReceiverPlayer.IDLE_TIMEOUT[e.toUpperCase()])},castReceiverPlayer.ChromecastPlayer.prototype.updateApplicationState_=function(){if(console.log("updateApplicationState_"),this.mediaManager_){var e=this.playerState_===castReceiverPlayer.State.IDLE,t=e?null:this.mediaManager_.getMediaInformation(),a=castReceiverPlayer.getApplicationState_(t);this.curAppState_!=a&&(this.curAppState_=a,this.receiverManager_.setApplicationState(a))}},castReceiverPlayer.ChromecastPlayer.prototype.onBuffering_=function(){console.log("onBuffering[readyState="+this.mediaElement_.readyState+"]"),this.playerState_===castReceiverPlayer.State.PLAYING&&this.mediaElement_.readyState<HTMLMediaElement.HAVE_ENOUGH_DATA&&this.setPlayerState_(castReceiverPlayer.State.BUFFERING,!1)},castReceiverPlayer.ChromecastPlayer.prototype.cancelDeferredPlay_=function(e){this.deferredPlayCallbackId_&&(console.log("Cancelled deferred playback: "+e),clearTimeout(this.deferredPlayCallbackId_),this.deferredPlayCallbackId_=null)},castReceiverPlayer.ChromecastPlayer.prototype.deferPlay_=function(e){console.log("Defering playback for "+e+" ms");var t=this;this.deferredPlayCallbackId_=setTimeout(function(){t.deferredPlayCallbackId_=null,t.player_?(console.log("Playing when enough data"),t.player_.playWhenHaveEnoughData()):(console.log("Playing"),t.mediaElement_.play())},e)},castReceiverPlayer.ChromecastPlayer.prototype.onLoadSuccess_=function(){console.log("onLoadSuccess");var e=this.mediaElement_.duration;this.loadedMediaInfor_.data.media.streamType===cast.receiver.media.StreamType.LIVE&&(e=this.loadedLiveDuration_),isNaN(e)?(this.totalTimeElement_.textContent="",this.progressBarInnerElement_.style.width="100%",this.progressBarThumbElement_.style.left="100%"):this.totalTimeElement_.textContent=castReceiverPlayer.formatDuration_(e)},castReceiverPlayer.getMediaImageUrl_=function(e){var t=e.metadata||{},a=t.images||[];return a&&a[0]&&a[0].url;
},castReceiverPlayer.getProtocolFunction_=function(e){var t=e.contentId,a=e.contentType||"",r=castReceiverPlayer.getPath_(t)||"";return"m3u8"===castReceiverPlayer.getExtension_(r)||"application/x-mpegurl"===a||"application/vnd.apple.mpegurl"===a?cast.player.api.CreateHlsStreamingProtocol:"mpd"===castReceiverPlayer.getExtension_(r)||"application/dash+xml"===a?cast.player.api.CreateDashStreamingProtocol:r.indexOf(".ism")>-1||"application/vnd.ms-sstr+xml"===a?cast.player.api.CreateSmoothStreamingProtocol:null},castReceiverPlayer.supportsPreload_=function(e){return null!=castReceiverPlayer.getProtocolFunction_(e)},castReceiverPlayer.canDisplayPreview_=function(e){var t=e.contentId||"",a=castReceiverPlayer.getPath_(t);return"mp4"===castReceiverPlayer.getExtension_(a)?!0:"ogv"===castReceiverPlayer.getExtension_(a)?!0:"webm"===castReceiverPlayer.getExtension_(a)?!0:!1},castReceiverPlayer.getType_=function(e){var t=e.contentId||"",a=e.contentType||"",r=castReceiverPlayer.getPath_(t);return 0===a.indexOf("audio/")?castReceiverPlayer.Type.AUDIO:0===a.indexOf("video/")?castReceiverPlayer.Type.VIDEO:0===a.indexOf("application/x-mpegurl")?castReceiverPlayer.Type.VIDEO:0===a.indexOf("application/vnd.apple.mpegurl")?castReceiverPlayer.Type.VIDEO:0===a.indexOf("application/dash+xml")?castReceiverPlayer.Type.VIDEO:0===a.indexOf("application/vnd.ms-sstr+xml")?castReceiverPlayer.Type.VIDEO:"mp3"===castReceiverPlayer.getExtension_(r)?castReceiverPlayer.Type.AUDIO:"oga"===castReceiverPlayer.getExtension_(r)?castReceiverPlayer.Type.AUDIO:"wav"===castReceiverPlayer.getExtension_(r)?castReceiverPlayer.Type.AUDIO:"mp4"===castReceiverPlayer.getExtension_(r)?castReceiverPlayer.Type.VIDEO:"ogv"===castReceiverPlayer.getExtension_(r)?castReceiverPlayer.Type.VIDEO:"webm"===castReceiverPlayer.getExtension_(r)?castReceiverPlayer.Type.VIDEO:"m3u8"===castReceiverPlayer.getExtension_(r)?castReceiverPlayer.Type.VIDEO:"mpd"===castReceiverPlayer.getExtension_(r)?castReceiverPlayer.Type.VIDEO:0!=a.indexOf(".ism")?castReceiverPlayer.Type.VIDEO:castReceiverPlayer.Type.UNKNOWN},castReceiverPlayer.transition_=function(e,t,a){0>=t||castReceiverPlayer.isCastForAudioDevice_()?a():castReceiverPlayer.fadeOut_(e,t/2,function(){a(),castReceiverPlayer.fadeIn_(e,t/2)})},castReceiverPlayer.preload_=function(e,t){function a(){++i===r.length&&t()}if(castReceiverPlayer.isCastForAudioDevice_())return void t();var r=[],i=0,o=[],s=castReceiverPlayer.getMediaImageUrl_(e);if(s&&r.push(s),0===r.length)t();else for(var n=0;n<r.length;n++)o[n]=new Image,o[n].src=r[n],o[n].onload=function(){a()},o[n].onerror=function(){a()}},castReceiverPlayer.isCastForAudioDevice_=function(){var e=window.cast.receiver.CastReceiverManager.getInstance();if(e){var t=e.getDeviceCapabilities();if(t)return t.display_supported===!1}return!1},castReceiverPlayer.ChromecastPlayer.prototype.getElementByClass_=function(e){var t=this.domElement_.querySelector(e);if(t)return t;throw Error("Cannot find child element: className = "+e+" from this domElement: id =  "+this.domElement_.id+", className = "+this.domElement_.className)},castReceiverPlayer.getPath_=function(e){var t=document.createElement("a");return t.href=e,t.pathname||""},castReceiverPlayer.setInnerText_=function(e,t){e&&(e.innerText=t||"")},castReceiverPlayer.setText_=function(e,t){e&&(e.innerHTML=t||"")},castReceiverPlayer.setBackgroundImage_=function(e,t){e&&(e.style.backgroundImage=t?'url("'+t.replace(/"/g,'\\"')+'")':"none",e.style.display=t?"":"none")},castReceiverPlayer.setImage_=function(e,t){e&&(e.src=t?'url("'+t.replace(/"/g,'\\"')+'")':"none",e.style.display=t?"":"none")},castReceiverPlayer.getExtension_=function(e){var t=e.split(".");return 1===t.length||""===t[0]&&2===t.length?"":t.pop().toLowerCase()},castReceiverPlayer.fadeTo_=function(e,t,a,r){var i=(Date.now(),function(){e.style.webkitTransition="",e.removeEventListener("webkitTransitionEnd",i,!1),r&&r()});e.addEventListener("webkitTransitionEnd",i,!1),e.style.webkitTransition="opacity "+a+"s",e.style.opacity=t},castReceiverPlayer.fadeIn_=function(e,t,a){castReceiverPlayer.fadeTo_(e,1,t,a)},castReceiverPlayer.fadeOut_=function(e,t,a){castReceiverPlayer.fadeTo_(e,0,t,a)},castReceiverPlayer.addClassWithTimeout_=function(e,t,a){return e.classList.add(t),setTimeout(function(){e.classList.remove(t)},a)},castReceiverPlayer.ChromecastPlayer.prototype.updateProgress_=function(){if(!castReceiverPlayer.isCastForAudioDevice_()){var e=this.mediaElement_.currentTime,t=this.mediaElement_.duration;if(!isNaN(e)&&!isNaN(t)){this.loadedMediaInfor_.data.media.streamType===cast.receiver.media.StreamType.LIVE&&(t=this.loadedLiveDuration_);var a=100*(e/t);this.curTimeElement_.innerText=castReceiverPlayer.formatDuration_(e),this.totalTimeElement_.innerText=castReceiverPlayer.formatDuration_(t),this.progressBarInnerElement_.style.width=a+"%",this.progressBarThumbElement_.style.left=a+"%",this.displayPreviewMode_&&(this.previewModeTimerElement_.innerText=""+Math.round(t-e))}}},castReceiverPlayer.formatDuration_=function(e){function t(e){return("00"+Math.round(e)).slice(-2)}e=Math.floor(e);var a=Math.floor(e/3600),r=Math.floor(e/60)%60,i=e%60;return a?t(a)+":"+t(r)+":"+t(i):"00:"+t(r)+":"+t(i)};
